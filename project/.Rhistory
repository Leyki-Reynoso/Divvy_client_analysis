ggplot(electric_immediate, aes(x = trip_distance)) +
geom_histogram(fill = "blue", color = "black") +
labs(title = "Frequency Distribution of trip_distance", x = "trip_distance", y = "Frequency")
classic_immediate %>%
select(everything())
electric_immediate %>%
select(everything()) %>%
view()
negative_times %>%
select(everything()) %>%
view()
trips_df %>%
select(everything()) %>%
filter(trip_duration <= 0) %>%
view()
trips_df %>%
select(everything()) %>%
filter(trip_duration < 0) %>%
view()
negative_trips %>%
select(everything()) %>%
filter(trips_df$start_station_name == trips_df$end_station_name)
negative_trips <- trips_df %>%
select(everything()) %>%
filter(trip_duration < 0) %>%
view()
negative_trips %>%
select(everything()) %>%
filter(trips_df$start_station_name == trips_df$end_station_name)
negative_trips %>%
select(everything()) %>%
filter(start_station_name == end_station_name)
negative_trips %>%
select(everything()) %>%
filter(start_station_name == end_station_name) %>%
view()
View(trips_df)
trips_df$trip_duration <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name & trips_df$start_station_name == "Out of station
",0, trips_df$trip_duration)
trips_df$trip_distance <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name,
0, trips_df$trip_duration)
trips_df$trip_duration <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name,
0, trips_df$trip_duration)
trips_df$trip_distance <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name,
0, trips_df$trip_duration)
negative_trips <- trips_df %>%
select(everything()) %>%
filter(trip_duration < 0) %>%
view()
negative_trips %>%
select(everything()) %>%
filter(start_station_name == end_station_name) %>%
view()
negative_trips <- trips_df %>%
select(everything()) %>%
filter(trip_duration < 0) %>%
view()
library(corrplot)
library(tidyverse)
library(ggplot2)
library(maps)
library(ggmap)
library(ggplot2)
library(tmap)
library(geosphere)
library(sf)
trips_df <- read_csv("../merged_data/trips_data.csv")
trips_df <- trips_df %>%
mutate(rideable_type = ifelse(rideable_type == "docked_bike",
"classic_bike", rideable_type))
unique(trips_df$rideable_type)
trips_df %>%
select(everything()) %>%
filter(end_lng == 0 | end_lat == 0)
trips_df <- trips_df %>%
mutate(end_lng = na_if(end_lng, 0),
end_lat = na_if(end_lat, 0))
trips_df %>%
select(everything()) %>%
filter(end_lat == 0 | end_lng == 0 )
trips_df %>%
select(everything()) %>%
filter(grepl("(Test)$", end_station_name, ignore.case=TRUE) | grepl("(Test)$", start_station_name, ignore.case=TRUE) |  grepl("(Test)$", start_station_id, ignore.case=TRUE) |  grepl("(Test)$", start_station_id, ignore.case=TRUE))
trips_df <- trips_df %>%
select(everything()) %>%
filter(!(grepl("(Test)$", end_station_name, ignore.case=TRUE) | grepl("(Test)$", start_station_name, ignore.case=TRUE) |  grepl("(Test)$", start_station_id, ignore.case=TRUE) |  grepl("(Test)$", start_station_id, ignore.case=TRUE)))
trips_df %>%
select(everything()) %>%
filter(grepl("(Test)$", end_station_name, ignore.case=TRUE) | grepl("(Test)$", start_station_name, ignore.case=TRUE) |  grepl("(Test)$", start_station_id, ignore.case=TRUE) |  grepl("(Test)$", start_station_id, ignore.case=TRUE)) %>%
count()
ggplot(trips_df, aes(x = end_lat)) +
geom_histogram(fill = "blue", color = "black") +
labs(title = "Frequency Distribution of end_lat", x = "end_lat", y = "Frequency")
ggplot(trips_df, aes(x = end_lng)) +
geom_histogram(fill = "blue", color = "black") +
labs(title = "Frequency Distribution of end_lng", x = "end_lng", y = "Frequency")
missing_lng_lat <- trips_df %>%
select(everything()) %>%
filter(!complete.cases(end_lng))
missing_lng_lat %>% count()
missing_lng_lat %>%
select(everything()) %>%
view()
ggplot(missing_lng_lat, aes(x = started_at)) +
geom_histogram(fill = "blue", color = "black") +
labs(title = "Frequency Distribution of started_at", x = "started_at", y = "Frequency")
ggplot(missing_lng_lat, aes(x = ended_at)) +
geom_histogram(fill = "blue", color = "black") +
labs(title = "Frequency Distribution of ended_at", x = "ended_at", y = "Frequency")
ggplot(missing_lng_lat, aes(x = rideable_type)) +
geom_bar(fill = "skyblue", color = "black") +
labs(title = "Frequency of Cylinder Categories", x = "Cylinders", y = "Count")
ggplot(missing_lng_lat, aes(x = member_casual)) +
geom_bar(fill = "skyblue", color = "black") +
labs(title = "Frequency of Cylinder Categories", x = "Cylinders", y = "Count")
missing_lng_lat_with_durations <- missing_lng_lat %>%
select(everything()) %>%
mutate(trip_duration = as.numeric(difftime(ended_at, started_at), units = "hours"))
missing_lng_lat_with_durations %>%
select(everything()) %>%
view()
summary(missing_lng_lat_with_durations$trip_duration)
missing_lng_lat_with_durations %>%
select(everything()) %>%
filter(trip_duration < 25 &  trip_duration > 23)
missing_lng_lat_with_durations %>%
select(everything()) %>%
filter(trip_duration > 25)
missing_lng_lat_with_durations %>%
select(everything()) %>%
filter(trip_duration < 23)
missing_lng_lat_with_durations %>%
filter(trip_duration < 23 & complete.cases(end_station_name)) %>%
count()
missing_lng_lat_with_durations %>%
filter(trip_duration >= 23 & complete.cases(end_station_name)) %>%
count()
short_trips_to_remove_list <- missing_lng_lat_with_durations %>%
filter(trip_duration < 23 & !complete.cases(end_station_name)) %>%
pull(ride_id)
short_trips_to_fix_list <- missing_lng_lat_with_durations %>%
filter(trip_duration < 23 & complete.cases(end_station_name)) %>%
pull(ride_id)
lost_bikes_list <- missing_lng_lat_with_durations %>%
filter(trip_duration > 23) %>%
pull(ride_id)
trips_df <- trips_df %>%
mutate(
end_station_name = ifelse(ride_id %in% lost_bikes_list, "Lost",end_station_name),
end_station_id = ifelse(ride_id %in% lost_bikes_list, "Lost",end_station_id),
)
trips_df <- trips_df %>%
filter(!(ride_id %in% short_trips_to_remove_list))
median_df <- trips_df %>%
group_by(end_station_name) %>%
summarize(median_end_lng = median(end_lng, na.rm = TRUE),
median_end_lat = median(end_lat, na.rm = TRUE)
)
trips_df <- trips_df %>%
left_join(median_df, by = "end_station_name") %>%
mutate(end_lng = ifelse(!complete.cases(end_lng) | (ride_id %in% short_trips_to_fix_list), median_end_lng, end_lng),
end_lat = ifelse(!complete.cases(end_lat) | (ride_id %in% short_trips_to_fix_list), median_end_lat, end_lat)) %>%
select(-median_end_lng, -median_end_lat)
trips_df %>%
filter(!complete.cases(end_lat, end_lng) & end_station_name != "Lost") %>%
count()
missing_stations <- trips_df %>%
select(everything()) %>%
filter(!complete.cases(start_station_id,end_station_id))
missing_stations_with_duration <- missing_stations %>%
select(everything()) %>%
mutate(trip_duration = as.numeric(difftime(ended_at, started_at), units = "hours"))
missing_stations_with_duration <- missing_stations_with_duration %>%
filter(trip_duration >= 0)
ggplot(missing_stations, aes(x = rideable_type)) +
geom_bar(fill = "skyblue", color = "black") +
labs(title = "Frequency of rideable_type Categories", x = "rideable_type", y = "Count")
ggplot(missing_stations_with_duration, aes(x = trip_duration)) +
geom_histogram(fill = "blue", color = "black") +
labs(title = "Frequency Distribution of ended_at", x = "ended_at", y = "Frequency")
missing_stations_with_duration %>%
filter(rideable_type == "electric_bike", trip_duration > 23)
trips_df <- trips_df %>%
mutate(start_station_name = ifelse(rideable_type == "electric_bike" & is.na(start_station_id),
"Out of station", start_station_name))
trips_df <- trips_df %>%
mutate(start_station_id = ifelse(rideable_type == "electric_bike" & is.na(start_station_id),
"Out of station", start_station_id))
trips_df <- trips_df %>%
mutate(end_station_name = ifelse(rideable_type == "electric_bike" & is.na(end_station_id),
"Out of station", end_station_name))
trips_df <- trips_df %>%
mutate(end_station_id = ifelse(rideable_type == "electric_bike" & is.na(end_station_id),
"Out of station", end_station_id))
missing_stations_with_duration <- missing_stations_with_duration %>%
filter(!complete.cases(start_station_name,end_station_name) , rideable_type == "classic_bike")
trips_df <- trips_df %>%
mutate(end_station_name = ifelse(rideable_type == "classic_bike" & is.na(end_station_id),
"Lost", end_station_name))
trips_df <- trips_df %>%
mutate(end_station_id = ifelse(rideable_type == "classic_bike" & is.na(end_station_id),
"Lost", end_station_id))
trips_df %>%
filter(!complete.cases(.) & end_station_id != "Lost")
trips_df <- trips_df %>%
filter(complete.cases(.) | end_station_id == "Lost")
trips_df %>%
select(everything()) %>%
filter(!complete.cases(.) & end_station_id != "Lost") %>%
count()
trips_df$rideable_type <- as.factor(trips_df$rideable_type)
class(trips_df$rideable_type)
trips_df$member_casual <- as.factor(trips_df$member_casual)
class(trips_df$rideable_type)
trips_df$start_station_id <- as.factor(trips_df$start_station_id)
class(trips_df$start_station_id)
trips_df$start_station_name <- as.factor(trips_df$start_station_name)
class(trips_df$start_station_name)
trips_df$end_station_name <- as.factor(trips_df$end_station_name)
class(trips_df$end_station_name)
trips_df$end_station_id <- as.factor(trips_df$end_station_id)
class(trips_df$end_station_id)
trips_df <- trips_df %>%
select(everything()) %>%
mutate(trip_duration = as.numeric(difftime(ended_at, started_at), units = "hours"))
trips_df <- trips_df %>%
rowwise() %>%
mutate(trip_distance = distHaversine(cbind(start_lng, start_lat), cbind(end_lng, end_lat)))
#trips_df <- read.csv("trips_data_cleaning.csv")
summary(trips_df$trip_distance)
summary(trips_df$trip_duration)
ggplot(trips_df, aes(x = trip_duration)) +
geom_histogram(fill = "blue", color = "black") +
labs(title = "Frequency Distribution of trip_duration", x = "trip_duration", y = "Frequency")
ggplot(trips_df, aes(x = trip_distance)) +
geom_histogram(fill = "blue", color = "black") +
labs(title = "Frequency Distribution of trip_duration", x = "trip_duration", y = "Frequency")
negative_trips <- trips_df %>%
select(everything()) %>%
filter(trip_duration < 0) %>%
view()
trips_df$trip_duration <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name & trips_df$start_station_name == "Out of station
",0, trips_df$trip_duration)
trips_df <- read_csv("trips_data_cleaning.csv")
trips_df$trip_duration <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name & trips_df$start_station_name == "Out of station
",0, trips_df$trip_duration)
trips_df$trip_distance <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name & trips_df$start_station_name == "Out of station
",0, trips_df$trip_distance)
trips_df$trip_distance <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name,
0, trips_df$trip_distance)
trips_df$trip_duration <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name,
0, trips_df$trip_duration)
negative_trips %>%
select(everything()) %>%
filter(start_station_name == end_station_name) %>%
view()
negative_trips %>%
select(everything()) %>%
filter(start_station_name == end_station_name) %>%
view()
trips_df$trip_duration <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name & trips_df$start_station_name == "Out of station
",0, trips_df$trip_duration)
trips_df$trip_distance <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name & trips_df$start_station_name == "Out of station
",0, trips_df$trip_distance)
trips_df$trip_distance <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name,
0, trips_df$trip_distance)
trips_df$trip_duration <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name,
0, trips_df$trip_duration)
negative_trips %>%
select(everything()) %>%
filter(start_station_name == end_station_name) %>%
view()
trips_df <- read_csv("trips_data_cleaning.csv")
trips_df <- trips_df[!(trips_df$trip_duration < 0 &
trips_df$start_station_name == trips_df$end_station_name &
trips_df$start_station_name == "Out of station"), ]
trips_df$trip_distance <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name & trips_df$start_station_name == "Out of station
",0, trips_df$trip_distance)
trips_df$trip_distance <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name,
0, trips_df$trip_distance)
trips_df$trip_duration <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name,
0, trips_df$trip_duration)
negative_trips %>%
select(everything()) %>%
filter(start_station_name == end_station_name) %>%
view()
trips_df <- trips_df[!(trips_df$trip_duration < 0 &
trips_df$start_station_name == trips_df$end_station_name &
trips_df$start_station_name == "Out of station"), ]
trips_df$trip_distance <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name,
0, trips_df$trip_distance)
trips_df$trip_duration <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name,
0, trips_df$trip_duration)
negative_trips %>%
select(everything()) %>%
filter(start_station_name == end_station_name) %>%
view()
trips_df <- trips_df[!(trips_df$trip_duration < 0 &
trimws(trips_df$start_station_name) == trimws(trips_df$end_station_name) &
trimws(trips_df$start_station_name) == "Out of station"), ]
trips_df$trip_distance <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name,
0, trips_df$trip_distance)
trips_df$trip_duration <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name,
0, trips_df$trip_duration)
negative_trips <- trips_df %>%
select(everything()) %>%
filter(trip_duration < 0) %>%
view()
negative_trips %>%
select(everything()) %>%
filter(start_station_name == end_station_name) %>%
view()
trips_df <- read_csv("trips_data_cleaning.csv")
trips_df <- trips_df[!(trips_df$trip_duration < 0 &
trimws(trips_df$start_station_name) == trimws(trips_df$end_station_name) &
trimws(trips_df$start_station_name) == "Out of station"), ]
trips_df$trip_distance <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name,
0, trips_df$trip_distance)
trips_df$trip_duration <- ifelse(trips_df$trip_duration < 0 & trips_df$start_station_name == trips_df$end_station_name,
0, trips_df$trip_duration)
negative_trips <- trips_df %>%
select(everything()) %>%
filter(trip_duration < 0) %>%
view()
negative_trips %>%
select(everything()) %>%
filter(start_station_name == end_station_name) %>%
view()
negative_trips <- trips_df %>%
select(everything()) %>%
filter(trip_duration < 0) %>%
view()
negative_trips %>%
select(everything()) %>%
view()
negative_trips <- trips_df %>%
select(everything()) %>%
filter(trip_duration < 0) %>%
view()
ggplot(negative_times, aes(x = started_at)) +
geom_histogram(fill = "blue", color = "black") +
labs(title = "Frequency Distribution of started_at", x = "started_at", y = "Frequency")
ggplot(negative_times, aes(x = ended_at)) +
geom_histogram(fill = "blue", color = "black") +
labs(title = "Frequency Distribution of ended_at", x = "ended_at", y = "Frequency")
ggplot(negative_times, aes(x = rideable_type)) +
geom_bar(fill = "skyblue", color = "black") +
labs(title = "Frequency of rideable_type Categories", x = "rideable_type", y = "Count")
ggplot(negative_times, aes(x = member_casual)) +
geom_bar(fill = "skyblue", color = "black") +
labs(title = "Frequency of member_casual Categories", x = "member_casual", y = "Count")
ggplot(negative_times, aes(x = trip_duration)) +
geom_histogram(fill = "blue", color = "black") +
labs(title = "Frequency Distribution of trip_duration", x = "trip_duration", y = "Frequency")
ggplot(negative_times, aes(x = trip_distance)) +
geom_histogram(fill = "blue", color = "black") +
labs(title = "Frequency Distribution of trip_distance", x = "trip_distance", y = "Frequency")
summary(negative_times$trip_distance)
summary(negative_times)
trips_df <- trips_df[!(trips_df$trip_duration < 0, ]
trips_df <- trips_df[!(trips_df$trip_duration < 0), ]
trips_df %>%
select(everything()) %>%
filter(trip_duration < 0) %>%
view()
trips_df %>%
select(everything()) %>%
filter(trip_duration < 0) %>%
count()
Lon_trips <- trips_df %>%
select(everything()) %>%
filter(trip_duration > 23) %>%
view()
Lon_trips <- trips_df %>%
select(everything()) %>%
filter(trip_duration > 23 & end_station_name != "Lost") %>%
view()
Long_trips <- trips_df %>%
select(everything()) %>%
filter(trip_duration > 23 & end_station_name != "Lost") %>%
view()
summary(Long_trips)
ggplot(Long_trips, aes(x = started_at)) +
geom_histogram(fill = "blue", color = "black") +
labs(title = "Frequency Distribution of started_at", x = "started_at", y = "Frequency")
ggplot(Long_trips, aes(x = ended_at)) +
geom_histogram(fill = "blue", color = "black") +
labs(title = "Frequency Distribution of ended_at", x = "ended_at", y = "Frequency")
ggplot(Long_trips, aes(x = rideable_type)) +
geom_bar(fill = "skyblue", color = "black") +
labs(title = "Frequency of rideable_type Categories", x = "rideable_type", y = "Count")
ggplot(Long_trips, aes(x = member_casual)) +
geom_bar(fill = "skyblue", color = "black") +
labs(title = "Frequency of member_casual Categories", x = "member_casual", y = "Count")
ggplot(Long_trips, aes(x = trip_duration)) +
geom_histogram(fill = "blue", color = "black") +
labs(title = "Frequency Distribution of trip_duration", x = "trip_duration", y = "Frequency")
ggplot(Long_trips, aes(x = trip_distance)) +
geom_histogram(fill = "blue", color = "black") +
labs(title = "Frequency Distribution of trip_distance", x = "trip_distance", y = "Frequency")
Long_trips <- trips_df %>%
select(everything()) %>%
filter(trip_duration > 23 & end_station_name != "Lost") %>%
view()
Long_trips %>%
select(everything()) %>%
filter(start_station_name == end_station_name) %>%
count()
summary(negative_times)
trips_df$rideable_type <- as.factor(trips_df$rideable_type)
class(trips_df$rideable_type)
trips_df$member_casual <- as.factor(trips_df$member_casual)
class(trips_df$rideable_type)
trips_df$start_station_id <- as.factor(trips_df$start_station_id)
class(trips_df$start_station_id)
trips_df$start_station_name <- as.factor(trips_df$start_station_name)
class(trips_df$start_station_name)
trips_df$end_station_name <- as.factor(trips_df$end_station_name)
class(trips_df$end_station_name)
trips_df$end_station_id <- as.factor(trips_df$end_station_id)
class(trips_df$end_station_id)
write.csv(trips_df, "trips_data_cleaned.csv", row.names = FALSE)
aggregate(trip_duration ~ member_casual, data = trips_df, summary)
aggregate(trip_distance ~ member_casual, data = trips_df, summary)
trips_df %>%
select()
library(tidyverse)
trips_df %>%
select()
print(aggregate(trip_duration ~ member_casual, data = trips_df, summary))
trips_df <- read_csv("../Exploration_and_Cleaning/trips_data_cleaned.csv")
trips_df %>%
select()
trips_df %>%
select()
library(corrplot)
library(tidyverse)
library(ggplot2)
library(maps)
library(ggmap)
library(ggplot2)
library(tmap)
library(geosphere)
library(sf)
print(aggregate(trip_duration ~ member_casual, data = trips_df, summary))
aggregate(trip_distance ~ member_casual, data = trips_df, summary)
trips_df %>%
select()
trips_df <- read_csv("../Exploration_and_Cleaning/trips_data_cleaned.csv")
trips_df %>%
select()
trips_df %>%
select()
trips_df %>%
select() %>%
head()
head(trips_df)
result <- aggregate(trip_distance ~ member_casual, data = trips_df, summary)
print(result)
setwd("C:/Users/Leyki/Desktop/case_study_1/project")
result <- aggregate(trip_distance ~ member_casual, data = trips_df, summary)
print(result)
result <- aggregate(trip_distance ~ member_casual, data = trips_df, summary)
head(result)
print(aggregate(trip_duration ~ member_casual, data = trips_df, summary))
aggregate(trip_distance ~ member_casual, data = trips_df, summary)
trips_df <- read_csv("../Exploration_and_Cleaning/trips_data_cleaned.csv")
trips_df <- read_csv("../Exploration_and_Cleaning/trips_data_cleaned.csv")
library(corrplot)
library(tidyverse)
library(ggplot2)
library(maps)
library(ggmap)
library(ggplot2)
library(tmap)
library(geosphere)
library(sf)
trips_df <- read_csv("../Exploration_and_Cleaning/trips_data_cleaned.csv")
result <- aggregate(trip_distance ~ member_casual, data = trips_df, summary)
head(result)
library(corrplot)
library(tidyverse)
library(ggplot2)
library(maps)
library(ggmap)
library(ggplot2)
library(tmap)
library(geosphere)
library(sf)
unique(trips_df$rideable_type)
result <- aggregate(trip_distance ~ member_casual, data = trips_df, summary)
head(result)
trips_df %>%
select()
head(trips_df)
result <- aggregate(trip_distance ~ member_casual, data = trips_df, summary)
head(result)
print(aggregate(trip_duration ~ member_casual, data = trips_df, summary))
print(aggregate(trip_duration ~ member_casual, data = trips_df, summary))
aggregate(trip_duration ~ member_casual, data = trips_df, summary)
trips_df %>%
select(member_casual, trip_duration) %>%  # Select only relevant columns
group_by(member_casual) %>%               # Group by member vs casual
summarise(
min_trip_duration = min(trip_duration, na.rm = TRUE),
first_quartile = quantile(trip_duration, 0.25, na.rm = TRUE),
median_trip_duration = median(trip_duration, na.rm = TRUE),
mean_trip_duration = mean(trip_duration, na.rm = TRUE),
third_quartile = quantile(trip_duration, 0.75, na.rm = TRUE),
max_trip_duration = max(trip_duration, na.rm = TRUE)
)
aggregate(trip_duration ~ member_casual, data = trips_df, summary)
